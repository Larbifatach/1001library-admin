<ng-template #library_forms let-model let-library_on_loading="library_on_loading" let-library_submiting="library_submiting" let-library_on_submit="library_on_submit" let-library_on_validate="library_on_validate">
    <div class="library__frms">
        <form name="form" autocomplete="off">
            @if (library_errors_msg) {<div class="library__notes"><i class="fi fi-rr-triangle-warning"></i> {{library_errors_msg}}</div>}
            <div class="library__frms-cols">
                <div class="library__frms-grp">
                    <label for="first_name">First Name</label>
                    <input id="first_name" [(ngModel)]="model.first_name" placeholder="First Name" name="first_name" type="text" required>
                </div>
                <div class="library__frms-grp">
                    <label for="last_name">Last Name</label>
                    <input id="last_name" [(ngModel)]="model.last_name" placeholder="Last Name" name="last_name" type="text" required>
                </div>
            </div>
            <div class="library__frms-cols">
                <div class="library__frms-grp">
                    <label for="display_name">Display Name</label>
                    <input id="display_name" [(ngModel)]="model.display_name" placeholder="Display Name" name="display_name" type="text" required>
                </div>
                <div class="library__frms-grp">
                    <label for="email">Email</label>
                    <input id="email" [(ngModel)]="model.email" placeholder="Email address" name="email" type="email" required>
                </div>
            </div>
            <div class="library__frms-grp">
                <label for="username">Username</label>
                <input id="username" [(ngModel)]="model.username" placeholder="Username" name="username" type="text" (ngModelChange)="library_edit_record.username = library_to_username($event)" required>
            </div>
            <div class="library__frms-grp library__frms-tgl">
                <label for="is_active">
                    {{ 'Is Active' }}
                    <input id="is_active" name="is_active" [(ngModel)]="model.is_active" type="checkbox">
                    <span class="library__frms-tgl-co"></span>
                </label>
            </div>
            <div class="library__frms-grp lib-pass">
                <label for="password">Password</label>
                <i class="library__auth-sh fi" [ngClass]="library_show_pass ? 'fi-rr-eye' : 'fi-rr-eye-crossed'" (click)="library_show_hide_pass()"></i>
                <input id="password" [(ngModel)]="model.password" placeholder="Password" name="password" [type]="library_show_pass ? 'text' : 'password'" required>
            </div>
            <!-- // -->
            <div class="library__frms-acts">
                <button [disabled]="library_on_loading || library_on_validate" type="button" (click)="library_on_submit()">
                <span>@if (!library_on_loading) { <i class="fi fi-rr-check"></i> {{library_submiting}} } @else {<i class="fi fi-rr-rotate-right lib-spin"></i>}</span>
                </button>
            </div>
        </form>
    </div>
</ng-template>
<!-- // -->
 <ng-template #library_temp_show let-modal> <div class="library__mdl-h"><h4><i class="fi fi-rr-eye"></i> Preview: <strong>{{library_data_record.display_name}}</strong></h4><button class="library__btns lib-circle lib-close" (click)="modal.dismiss()"><i class="fi fi-rr-cross-small"></i></button></div>
  <div class="library__mdl-b">
    <div class="library__infos">
        <div class="library__info">
            <div class="library__info-t"><span><i class="fi fi-rr-user"></i> {{ 'Profil' }}</span></div>
            <div class="library__info-b">
                <ul>
                    <li>
                        <span>{{ 'First Name' }}</span>
                        <p>{{library_data_record.first_name}}</p>
                    </li>
                    <li>
                        <span>{{ "Last Name" }}</span>
                        <p>{{library_data_record.last_name}}</p>
                    </li>
                    <li>
                        <span>{{ "Display Name" }}</span>
                        <p>{{ library_data_record.display_name }}</p>
                    </li>
                    <li>
                        <span>{{ "Email" }}</span>
                        <p>{{library_data_record.email}}</p>
                    </li>
                    @if (library_data_record.phone) { 
                        <li>
                            <span>{{ "Phone" }}</span>
                            <p>{{library_data_record.phone}}</p>
                        </li>
                    }
                </ul>
            </div>
        </div>
        <div class="library__info">
            <div class="library__info-t"><span><i class="fi fi-rr-users"></i> {{ 'Account' }}</span></div>
            <div class="library__info-b">
                <ul>
                    <li>
                        <span>{{ "Registred" }}</span>
                        <p>{{library_data_record.created | date:'dd MMM, yy'}}</p>
                    </li>
                    <li>
                        <span>{{ 'Registred IP' }}</span>
                        <p>{{library_data_record.register_ip}}</p>
                    </li>
                    <li>
                        <span>{{ "Points" }}</span>
                        <p>{{library_data_record.points}}</p>
                    </li>
                    <li>
                        <span>{{ "Level" }}</span>
                        <p>{{library_data_record.lvl}}</p>
                    </li>
                    <li>
                        <span>{{ "Balance" }}</span>
                        <p>{{library_data_record.balance}} <del>{{ "USD" }}</del></p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="library__info">
            <div class="library__info-t"><span><i class="fi fi-rr-coins"></i> {{ 'Numbers' }}</span></div>
            <div class="library__info-b">
                <ul>
                    <li>
                        <span>{{ "Downloads" }}</span>
                        <p>{{library_data_record.downloads}}</p>
                    </li>
                    <li>
                        <span>{{ "Reviews" }}</span>
                        <p>{{library_data_record.reviews}}</p>
                    </li>
                    <li>
                        <span>{{ "Suggests" }}</span>
                        <p>{{library_data_record.suggests}}</p>
                    </li>
                    <li>
                        <span>{{ "Report book" }}</span>
                        <p>{{library_data_record.reports_book}}</p>
                    </li>
                    <li>
                        <span>{{ "Report links" }}</span>
                        <p>{{library_data_record.reports_links}}</p>
                    </li>
                </ul>
            </div>
        </div>
    </div>
  </div>
</ng-template>
<ng-template #library_temp_edit let-modal> <div class="library__mdl-h"><h4><i class="fi fi-rr-pencil"></i> Edit: <strong>{{library_data_record.display_name}}</strong></h4><button class="library__btns lib-circle lib-close" (click)="modal.dismiss()"><i class="fi fi-rr-cross-small"></i></button></div>
  <div class="library__mdl-b">
    <ng-container *ngTemplateOutlet="library_forms; context: { $implicit: library_edit_record,
      library_on_loading: library_load_btns,
      library_on_validate: library_edit_validate,
      library_submiting: 'Update',
      library_on_submit: library_update_btn.bind(this)
    }"> </ng-container>
  </div>
</ng-template>
<ng-template #library_temp_delete let-modal> <library-deletes
  [library_title]="'Delete'"
  [library_name]="library_data_record.display_name"
  [library_load]="library_load_btns"
  [library_error]="library_errors_msg"
  [library_text]="'Are you sure<br>you want to delete this member?<br>All associated data will be deleted.'"
  (library_close)="modal.dismiss()"
  (library_confirm)="library_delete_record(library_data_record.id, library_index)">
</library-deletes> </ng-template>
<!-- // -->
<div class="library__main">
    <div class="library__heads">
        <div class="library__heads-t">
            <h1><i class="fi fi-rr-users"></i> {{ 'Members' }}</h1>
        </div>
        <div class="library__heads-fs library__frms"><div class="library__flex library__heads-f">
            <div class="library__frms-grp lib-wicn_r lib-last">
                <i class="fi fi-rr-user"></i>
                <input placeholder="{{'Per name'}}" [(ngModel)]="library_filters['name']" id="library_filter_name" name="library_filter_name" type="text" (keyup.enter)="library_get_filtred()">
            </div>
            <div class="library__frms-grp lib-wicn_r lib-last">
                <i class="fi fi-rr-envelope"></i>
                <input placeholder="{{'Per Email'}}" [(ngModel)]="library_filters['email']" id="library_filter_email" name="library_filter_email" type="text" (keyup.enter)="library_get_filtred()">
            </div>
        </div>
        <library-nums [library_model]="library_filters" [library_has_fltr]="library_hasfltr" (library_changed)="library_get_filtred()" (library_clear)="library_rmv_filtred()"></library-nums></div>
    </div>
    <library-tables
        [library_loads]="library_loading"
        [library_total]="library_ttl_posts"
        [library_page]="library_page"
        [library_pages]="library_ttl_pages"
        (library_paginate)="library_pagination($event)" >
        <div class="library__tbls">
            <div class="library__tbls-h">
                <div class="library__tbls-col library__tbls-col-1">{{'Member'}}</div>
                <div class="library__tbls-col library__tbls-col-2">{{"Downloads"}}</div>
                <div class="library__tbls-col library__tbls-col-3">{{'Contact'}}</div>
                <div class="library__tbls-col library__tbls-col-4">{{"Registered"}}</div>
                <div class="library__tbls-col library__tbls-col-5">{{"Points"}}</div>
                <div class="library__tbls-col library__tbls-col-6"></div>
            </div>
            @for (record of library_records; track record.id) {
                <div class="library__tbls-r">
                    <div class="library__tbls-col library__tbls-col-1 library__flex lib-avatar" data-label="Member">
                        <img [src]="record.avatar_url || '/img/library-avatar.png'">
                        <h5>{{record.display_name}}</h5>
                        @if(!record.is_active){<span class="lib-bdge lib-nop">{{"Suspended"}}</span>}
                    </div>
                    <div class="library__tbls-col library__tbls-col-2 library__flex" data-label="Downloads">
                        <span class="lib-empty">{{ record.downloads }}</span>
                    </div>
                    <div class="library__tbls-col library__tbls-col-3 library__flex" data-label="Contact">
                        <span [ngbTooltip]="record.email" class="lib-icon lib-contact"><i class="fi fi-rr-envelope"></i></span>
                        @if (record.phone) { <span [ngbTooltip]="record.phone" class="lib-icon lib-contact"><i class="fi fi-rr-phone-flip"></i></span> }
                    </div>
                    <div class="library__tbls-col library__tbls-col-4 library__flex" data-label="Registered">
                        <span class="lib-empty">{{ record.created | date:'dd MMM, yy' }}</span>
                    </div>
                    <div class="library__tbls-col library__tbls-col-5 library__flex" data-label="Points">
                        <span class="lib-empty">{{ record.points}} {{"Pts"}}</span>
                    </div>
                    <div class="library__tbls-col library__tbls-col-6" data-label="Action">
                        <div class="library__flex lib-last">
                            <button class="library__btns lib-circle" ngbTooltip="{{'Preview'}}" (click)="library_modal_show(library_temp_show, record, $index)"><i class="fi fi-rr-eye"></i></button>
                            <button class="library__btns lib-circle lib-edit" ngbTooltip="{{'Edit'}}" (click)="library_modal_edit(library_temp_edit, record, $index)"><i class="fi fi-rr-pencil"></i></button>
                            <button class="library__btns lib-circle lib-close" ngbTooltip="{{'Delete'}}" (click)="library_modal_delete(library_temp_delete, record, $index)"><i class="fi fi-rr-trash"></i></button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </library-tables>
</div>